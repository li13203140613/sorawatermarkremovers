# Sora2 提示词生成器测试清单

## 测试环境
- **URL**: http://localhost:3000
- **浏览器**: Chrome / Edge / Firefox
- **状态**: ✅ 开发服务器已启动，无编译错误

---

## ✅ 最新更新：DeepSeek API 集成完成

### 代码迁移已完成
- ✅ **旧逻辑已删除**：客户端 `generatePrompt()` 模板填充逻辑已移除
- ✅ **新逻辑已实现**：调用 `/api/prompt-generator/generate-batch` API
- ✅ **DeepSeek AI 集成**：使用新系统提示词（Style/Scene/Cinematography/Actions/Sound格式）
- ✅ **构建成功**：无 TypeScript 错误
- ✅ **服务器运行**：http://localhost:3000 ✅

### 关键变更
- 文件：`components/prompt-generator/PromptGeneratorForm.tsx`
- 变更：`handleGenerate()` 从同步函数改为异步 API 调用
- API 端点：POST `/api/prompt-generator/generate-batch`
- 预期成本：~¥0.012-0.015 per prompt (~1.2-1.5分)

---

## 🎯 **优先测试：API 集成验证**

### Test A: 简单模式 - DeepSeek API 测试

**步骤**:
1. 打开浏览器 → `http://localhost:3000/zh`
2. 确认默认选中"简单模式"
3. 在文本框输入：`一个女孩在花园里弹吉他`
4. 生成数量选择：`3 个提示词`
5. 点击"生成提示词"按钮

**浏览器开发者工具验证（F12 → Network）**:
- [ ] 看到 POST 请求到 `/api/prompt-generator/generate-batch`
- [ ] 请求体格式：
  ```json
  {
    "scene": "一个女孩在花园里弹吉他",
    "category": "cinematic",
    "count": 3,
    "language": "zh"
  }
  ```
- [ ] 响应状态码：`200 OK`
- [ ] 响应体包含 `success: true` 和 `data.prompts` 数组

**UI 验证**:
- [ ] 按钮变为"生成中..."
- [ ] 按钮禁用状态
- [ ] 自动滚动到结果区域
- [ ] 显示 3 个提示词卡片

**内容质量验证**:
- [ ] 提示词使用结构化格式：
  ```
  Style: ...
  Scene: ...
  Cinematography: ...
  Actions: ...
  Sound: ...
  ```
- [ ] 提示词长度约 150-250 词
- [ ] 每个提示词显示 Token 使用量（~1000-1200）
- [ ] 每个提示词显示成本（~¥0.012-0.015）

**预期输出示例**:
```
Style: 温馨自然的生活记录风格，柔和的自然光线...
Scene: 午后的私人花园，阳光透过树叶洒下斑驳光影...
Cinematography:
- Camera: 中景镜头，缓慢推进
- Lens: 35mm焦距，浅景深
Actions:
- 女孩手指轻拨琴弦
- 微风吹动花瓣飘落
Sound: 吉他旋律、鸟鸣、微风沙沙声
```

---

### Test B: 高级模式 - 所有字段融合测试

**步骤**:
1. 切换到"高级模式"标签
2. 选择"电影叙事"分类
3. 填写所有字段：
   - 场景描述：`一只橘猫在雨天走到街道上`
   - 风格：`Cinematic / 电影级`
   - 时长：`8 seconds`
   - 氛围：`孤独、宁静、略带忧郁`
   - 镜头类型：`Wide Shot / 全景`
   - 主体描述：`橘色虎斑猫`
   - 动作描述：`小心翼翼地走路，突然驻足仰头`
   - 环境细节：`被雨水浸湿的鹅卵石小巷，老旧砖墙，青苔`
   - 光线类型：`Warm Light / 暖色调光`
   - 镜头运动：`Tracking / 跟踪镜头`
4. 点击"生成提示词"

**验证**:
- [ ] API 请求的 `scene` 字段包含所有填写值
- [ ] 生成的提示词自然融合所有参数
- [ ] 提示词专业度高，不是简单参数拼接

---

### Test C: 错误处理测试

**步骤 1: 空输入**
1. 清空所有字段
2. 直接点击"生成提示词"

**预期**:
- [ ] 显示错误提示：`请输入您的创意描述`（简单模式）
- [ ] 或 `请至少填写一个字段`（高级模式）
- [ ] 按钮保持可点击状态

**步骤 2: 重置功能**
1. 填写表单后点击"重置"按钮

**预期**:
- [ ] 所有字段清空
- [ ] 错误提示清除

---

## ✅ 配置修复完成

### 1. Next.js 配置更新
- ✅ 将 `experimental.serverComponentsExternalPackages` 更新为 `serverExternalPackages`
- ✅ 添加 `outputFileTracingRoot` 以解决多个 lockfile 警告
- ✅ 无 React Hook 错误
- ✅ 无控制台警告

---

## 测试项目

### 1️⃣ 页面加载测试
**步骤**:
1. 打开浏览器访问 http://localhost:3000
2. 等待页面完全加载

**预期结果**:
- [  ] 页面正常加载，无白屏
- [  ] 无控制台错误
- [  ] 可以看到标题"AI Sora2 提示词生成器"
- [  ] 可以看到 7 个分类标签

---

### 2️⃣ 分类标签切换测试
**步骤**:
1. 依次点击以下分类标签：
   - [  ] 🎬 电影叙事
   - [  ] 🌿 自然风光
   - [  ] 👤 人物肖像
   - [  ] 📦 产品展示
   - [  ] ⚡ 动作运动
   - [  ] 🎨 抽象艺术
   - [  ] 📹 生活记录

**预期结果**:
- [  ] 每次点击后，标签样式改变（绿色高亮）
- [  ] 下方的表单字段动态更新
- [  ] 不同分类显示不同的字段
- [  ] 切换流畅，无卡顿

---

### 3️⃣ 表单字段测试
**步骤**:
1. 选择"电影叙事"分类
2. 查看表单字段：
   - [  ] 可以看到多个下拉框（至少5个）
   - [  ] 每个下拉框有标签名称（如"镜头类型"等）
   - [  ] 每个下拉框有默认的占位符选项（如"请选择..."）
3. 依次打开每个下拉框：
   - [  ] 可以看到多个选项
   - [  ] 选项内容合理（如镜头类型包含"特写"、"远景"等）

**预期结果**:
- [  ] 所有字段渲染正常
- [  ] 字段排列为 3 列网格布局（桌面）
- [  ] 字段排列为 1 列（移动端）
- [  ] 必填字段有红色星号标记

---

### 4️⃣ 表单填写测试
**步骤**:
1. 选择"电影叙事"分类
2. 填写至少 3 个必填字段（带*号的）
3. 观察表单状态：
   - [  ] 选择后值保留在下拉框中
   - [  ] 可以修改已选择的值

**预期结果**:
- [  ] 字段值正常保存
- [  ] 切换到其他分类后再回来，值被清空（这是正常行为）

---

### 5️⃣ 提示词数量选择测试
**步骤**:
1. 查找"生成数量"或类似的下拉框
2. 选择不同的数量：
   - [  ] 可以选择 1 个
   - [  ] 可以选择 2 个
   - [  ] 可以选择 3 个

**预期结果**:
- [  ] 数量选择器正常工作
- [  ] 默认选中 3 个

---

### 6️⃣ 提示词生成测试
**步骤**:
1. 填写必填字段
2. 点击"生成提示词"按钮
3. 观察：
   - [  ] 按钮显示加载状态
   - [  ] 页面自动滚动到结果区域
   - [  ] 显示 3 个提示词卡片（如果选择了 3 个）

**预期结果**:
- [  ] 提示词成功生成
- [  ] 每个提示词内容不同（有变化）
- [  ] 提示词内容合理，包含所选字段的值
- [  ] 卡片布局为 3 列网格

**示例输出**:
```
Variant 1: Close-up of a detective in a dark alley, shot on ARRI Alexa, cinematic...
Variant 2: Wide shot of a detective in a dark alley, shot on RED Dragon, dramatic...
Variant 3: Medium shot of a detective in a dark alley, shot on Sony Venice, moody...
```

---

### 7️⃣ 提示词卡片操作测试
**步骤**:
针对生成的每个提示词卡片，测试以下功能：

**7.1 复制功能**
1. 点击"📋 复制"按钮
2. 粘贴到记事本或其他地方

**预期结果**:
- [  ] 复制成功
- [  ] 复制的内容与显示的提示词一致
- [  ] 显示"已复制"提示（如果有）

**7.2 分享功能**（如果实现）
1. 点击"🔗 分享"按钮

**预期结果**:
- [  ] 分享功能正常（具体行为待确认）

**7.3 下载功能**（如果实现）
1. 点击"⬇️ 下载"按钮

**预期结果**:
- [  ] 下载功能正常（具体行为待确认）

---

### 8️⃣ 表单验证测试
**步骤**:
1. 不填写任何字段
2. 直接点击"生成提示词"按钮

**预期结果**:
- [  ] 显示错误提示
- [  ] 指出哪些必填字段未填写
- [  ] 未生成提示词

---

### 9️⃣ 所有分类全流程测试
**步骤**:
对每个分类重复步骤 3-8：
- [  ] 🎬 电影叙事
- [  ] 🌿 自然风光
- [  ] 👤 人物肖像
- [  ] 📦 产品展示
- [  ] ⚡ 动作运动
- [  ] 🎨 抽象艺术
- [  ] 📹 生活记录

**预期结果**:
- [  ] 所有分类都能正常生成提示词
- [  ] 每个分类的提示词内容符合分类特征

---

### 🔟 响应式布局测试
**步骤**:
1. 在不同屏幕尺寸下测试：
   - [  ] 桌面（>= 1024px）- 3列布局
   - [  ] 平板（768px - 1023px）- 2列布局
   - [  ] 手机（< 768px）- 1列布局

2. 缩放浏览器窗口，观察：
   - [  ] 布局自动调整
   - [  ] 文字可读性良好
   - [  ] 按钮和交互元素大小合适

**预期结果**:
- [  ] 所有屏幕尺寸下都能正常使用
- [  ] 移动端体验良好

---

## 🐛 已知问题（待修复）

### 当前无已知问题

---

## 📊 测试结果总结

### 通过的测试
- ✅ 服务器启动无错误
- ✅ Next.js 配置已优化
- ✅ TypeScript 编译通过

### 待测试项
- ⏳ 所有 UI 功能（等待手动测试）
- ⏳ Playwright 自动化测试（等待 Chromium 下载完成）

---

## 📝 测试记录

**测试人员**:
**测试日期**:
**浏览器**:
**结果**:

**发现的问题**:
1.
2.
3.

**建议**:
1.
2.
3.
